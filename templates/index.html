<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>TeleSpam</title>
</head>
<body>
    <h1>TeleSpam</h1>
    <form id="sendForm" method="post">
        <label>Цель рассылки (all или favorites):</label><br>
        <input type="text" id="mode" value="all" name="target"><br><br>
        <label>Интервал (секунды):</label><br>
        <input type="number" id="interval" value="60" name="interval"><br><br>
        <label>Сессия:</label><br>
        <input type="text" id="session" value="account1"><br><br>
        <button type="submit">Запустить рассылку</button>
    </form>
    <pre id="log"></pre>
    <script>
        const form = document.getElementById('sendForm');
        form.addEventListener('submit', async e => {
            e.preventDefault();
            await fetch('/send', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    session_name: document.getElementById('session').value,
                    mode: document.getElementById('mode').value,
                    interval: parseFloat(document.getElementById('interval').value)
                })
            });
        });
        async function updateLog() {
            const r = await fetch('/log');
            const data = await r.json();
            document.getElementById('log').textContent = data.log.join('\n');
        }
        setInterval(updateLog, 2000);
    </script>
</body>
</html>
